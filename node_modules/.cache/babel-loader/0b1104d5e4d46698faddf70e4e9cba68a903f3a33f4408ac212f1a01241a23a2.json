{"ast":null,"code":"import { useRouter } from 'vue-router';\nimport { useAppStore } from '@/stores/app';\nexport default {\n  name: 'ResultPage',\n  setup() {\n    const router = useRouter();\n    const appStore = useAppStore();\n\n    // 语言感知的导航函数\n    const navigateTo = path => {\n      const currentPath = router.currentRoute.value.path;\n      const isEnglish = currentPath.startsWith('/en');\n      const targetPath = isEnglish ? `/en${path}` : path;\n      router.push(targetPath);\n    };\n    return {\n      router,\n      appStore,\n      navigateTo\n    };\n  },\n  data() {\n    return {\n      incenseCount: 1,\n      selectedCurrency: 'SOL',\n      currencyRates: {\n        SOL: 0.01,\n        USDT: 1,\n        BTC: 0.00001,\n        ETH: 0.0003\n      },\n      processing: false,\n      paymentCompleted: false,\n      paymentInfo: null,\n      error: null\n    };\n  },\n  computed: {\n    fortuneResult() {\n      // 从store获取算命结果\n      const result = this.appStore.fortuneResult;\n      if (result && result.result) {\n        return `${result.result.title} - ${result.result.description}\\n\\n${result.result.advice}`;\n      }\n      return '根据您提供的数字，神明指示：前路光明，贵人相助，但需谨慎行事，避免冲动。近期财运亨通，事业有成，感情和睦。建议多行善事，积累功德。';\n    },\n    totalPrice() {\n      return (this.incenseCount * this.currencyRates[this.selectedCurrency]).toFixed(8);\n    },\n    isValidSelection() {\n      return this.incenseCount > 0 && this.incenseCount <= 100 && this.selectedCurrency;\n    }\n  },\n  mounted() {\n    // 检查是否有之前的支付信息\n    const savedPaymentInfo = localStorage.getItem('paymentInfo');\n    if (savedPaymentInfo) {\n      try {\n        const info = JSON.parse(savedPaymentInfo);\n        // 如果支付信息是最近5分钟内的，显示为已完成\n        const paymentTime = new Date(info.timestamp);\n        const now = new Date();\n        if (now - paymentTime < 5 * 60 * 1000) {\n          this.paymentCompleted = true;\n          this.paymentInfo = info;\n        }\n      } catch (e) {\n        console.error('Failed to parse payment info:', e);\n      }\n    }\n  },\n  methods: {\n    async processPayment() {\n      if (!this.isValidSelection) return;\n      this.processing = true;\n      this.error = null;\n      try {\n        // 模拟支付处理\n        await new Promise(resolve => setTimeout(resolve, 3000));\n\n        // 创建支付信息\n        const paymentInfo = {\n          incenseCount: this.incenseCount,\n          currency: this.selectedCurrency,\n          totalPrice: this.totalPrice,\n          timestamp: new Date().toISOString()\n        };\n\n        // 保存支付信息\n        this.paymentInfo = paymentInfo;\n        localStorage.setItem('paymentInfo', JSON.stringify(paymentInfo));\n\n        // 添加功德分\n        this.appStore.addMeritPoints(this.incenseCount * 10);\n\n        // 添加上香记录\n        this.appStore.addIncenseRecord({\n          count: this.incenseCount,\n          currency: this.selectedCurrency,\n          amount: this.totalPrice,\n          meritGained: this.incenseCount * 10\n        });\n        this.paymentCompleted = true;\n      } catch (error) {\n        this.error = '支付失败，请重试';\n        console.error('支付失败:', error);\n      } finally {\n        this.processing = false;\n      }\n    },\n    proceedToWorship() {\n      // 跳转到上香页面\n      this.navigateTo('/worship');\n    }\n  }\n};","map":{"version":3,"names":["useRouter","useAppStore","name","setup","router","appStore","navigateTo","path","currentPath","currentRoute","value","isEnglish","startsWith","targetPath","push","data","incenseCount","selectedCurrency","currencyRates","SOL","USDT","BTC","ETH","processing","paymentCompleted","paymentInfo","error","computed","fortuneResult","result","title","description","advice","totalPrice","toFixed","isValidSelection","mounted","savedPaymentInfo","localStorage","getItem","info","JSON","parse","paymentTime","Date","timestamp","now","e","console","methods","processPayment","Promise","resolve","setTimeout","currency","toISOString","setItem","stringify","addMeritPoints","addIncenseRecord","count","amount","meritGained","proceedToWorship"],"sources":["/Users/Jordan/workSpace/temple/src/views/ResultPage.vue"],"sourcesContent":["<template>\n  <div class=\"result-page\">\n    <div class=\"container\">\n      <h1>{{ $t('result.title') }}</h1>\n      \n      <div class=\"main-content\">\n        <!-- 左侧：算命结果 -->\n        <div class=\"result-section\">\n          <div class=\"fortune-result\">\n            <h2>神算结果</h2>\n            <div class=\"result-content\">\n              <p>{{ fortuneResult }}</p>\n            </div>\n          </div>\n          \n          <div class=\"blessing-hint\">\n            <h3>六神已定，虔诚上香，神明护佑</h3>\n            <p>请在右侧选择香火数量并完成支付，诚心上香获得神明护佑。</p>\n          </div>\n        </div>\n\n        <!-- 下方：支付功能 -->\n        <div class=\"payment-section\">\n          <div class=\"payment-form\">\n            <h2>香火支付</h2>\n            <p class=\"payment-description\">选择香火数量，虔诚支付获得护佑</p>\n            \n            <div class=\"incense-selection\">\n              <div class=\"input-group\">\n                <label>香火数量</label>\n                <input\n                  type=\"number\"\n                  v-model.number=\"incenseCount\"\n                  min=\"1\"\n                  max=\"100\"\n                  placeholder=\"请输入香火数量\"\n                  class=\"count-input\"\n                />\n              </div>\n              \n              <div class=\"input-group\">\n                <label>选择币种</label>\n                <select v-model=\"selectedCurrency\" class=\"currency-select\">\n                  <option value=\"SOL\">SOL</option>\n                  <option value=\"USDT\">USDT</option>\n                  <option value=\"BTC\">BTC</option>\n                  <option value=\"ETH\">ETH</option>\n                </select>\n              </div>\n            </div>\n            \n            <div class=\"price-display\">\n              <p>总价: <span class=\"price\">{{ totalPrice }} {{ selectedCurrency }}</span></p>\n            </div>\n            \n            <button \n              @click=\"processPayment\"\n              :disabled=\"!isValidSelection || processing\"\n              class=\"payment-btn\"\n            >\n              {{ processing ? '支付中...' : '立即支付' }}\n            </button>\n\n            <div v-if=\"error\" class=\"error-message\">\n              {{ error }}\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { useRouter } from 'vue-router'\nimport { useAppStore } from '@/stores/app'\n\nexport default {\n  name: 'ResultPage',\n  setup() {\n    const router = useRouter()\n    const appStore = useAppStore()\n    \n    // 语言感知的导航函数\n    const navigateTo = (path) => {\n      const currentPath = router.currentRoute.value.path\n      const isEnglish = currentPath.startsWith('/en')\n      const targetPath = isEnglish ? `/en${path}` : path\n      router.push(targetPath)\n    }\n    \n    return {\n      router,\n      appStore,\n      navigateTo\n    }\n  },\n  data() {\n    return {\n      incenseCount: 1,\n      selectedCurrency: 'SOL',\n      currencyRates: {\n        SOL: 0.01,\n        USDT: 1,\n        BTC: 0.00001,\n        ETH: 0.0003\n      },\n      processing: false,\n      paymentCompleted: false,\n      paymentInfo: null,\n      error: null\n    }\n  },\n  computed: {\n    fortuneResult() {\n      // 从store获取算命结果\n      const result = this.appStore.fortuneResult\n      if (result && result.result) {\n        return `${result.result.title} - ${result.result.description}\\n\\n${result.result.advice}`\n      }\n      return '根据您提供的数字，神明指示：前路光明，贵人相助，但需谨慎行事，避免冲动。近期财运亨通，事业有成，感情和睦。建议多行善事，积累功德。'\n    },\n    totalPrice() {\n      return (this.incenseCount * this.currencyRates[this.selectedCurrency]).toFixed(8)\n    },\n    isValidSelection() {\n      return this.incenseCount > 0 && this.incenseCount <= 100 && this.selectedCurrency\n    }\n  },\n  mounted() {\n    // 检查是否有之前的支付信息\n    const savedPaymentInfo = localStorage.getItem('paymentInfo')\n    if (savedPaymentInfo) {\n      try {\n        const info = JSON.parse(savedPaymentInfo)\n        // 如果支付信息是最近5分钟内的，显示为已完成\n        const paymentTime = new Date(info.timestamp)\n        const now = new Date()\n        if (now - paymentTime < 5 * 60 * 1000) {\n          this.paymentCompleted = true\n          this.paymentInfo = info\n        }\n      } catch (e) {\n        console.error('Failed to parse payment info:', e)\n      }\n    }\n  },\n  methods: {\n    async processPayment() {\n      if (!this.isValidSelection) return\n      \n      this.processing = true\n      this.error = null\n      \n      try {\n        // 模拟支付处理\n        await new Promise(resolve => setTimeout(resolve, 3000))\n        \n        // 创建支付信息\n        const paymentInfo = {\n          incenseCount: this.incenseCount,\n          currency: this.selectedCurrency,\n          totalPrice: this.totalPrice,\n          timestamp: new Date().toISOString()\n        }\n        \n        // 保存支付信息\n        this.paymentInfo = paymentInfo\n        localStorage.setItem('paymentInfo', JSON.stringify(paymentInfo))\n        \n        // 添加功德分\n        this.appStore.addMeritPoints(this.incenseCount * 10)\n        \n        // 添加上香记录\n        this.appStore.addIncenseRecord({\n          count: this.incenseCount,\n          currency: this.selectedCurrency,\n          amount: this.totalPrice,\n          meritGained: this.incenseCount * 10\n        })\n        \n        this.paymentCompleted = true\n        \n      } catch (error) {\n        this.error = '支付失败，请重试'\n        console.error('支付失败:', error)\n      } finally {\n        this.processing = false\n      }\n    },\n    \n    proceedToWorship() {\n      // 跳转到上香页面\n      this.navigateTo('/worship')\n    }\n  }\n}\n</script>\n\n<style scoped>\n.result-page {\n  min-height: 100vh;\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n  padding: 2rem;\n}\n\n.container {\n  max-width: 1200px;\n  margin: 0 auto;\n}\n\nh1 {\n  text-align: center;\n  color: white;\n  margin-bottom: 2rem;\n  font-size: 2.5rem;\n}\n\n.main-content {\n  display: flex;\n  flex-direction: column;\n  gap: 2rem;\n}\n\n.result-section {\n  background: rgba(255, 255, 255, 0.9);\n  border-radius: 20px;\n  padding: 2rem;\n  backdrop-filter: blur(10px);\n}\n\n.fortune-result {\n  margin-bottom: 2rem;\n}\n\n.fortune-result h2 {\n  color: #333;\n  margin-bottom: 1rem;\n  text-align: center;\n}\n\n.result-content {\n  background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);\n  padding: 1.5rem;\n  border-radius: 10px;\n  border-left: 4px solid #667eea;\n}\n\n.result-content p {\n  color: #555;\n  font-size: 1.1rem;\n  line-height: 1.6;\n  margin: 0;\n  white-space: pre-line;\n}\n\n.blessing-hint {\n  text-align: center;\n  padding: 1.5rem;\n  background: linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%);\n  border-radius: 10px;\n}\n\n.blessing-hint h3 {\n  color: #856404;\n  margin-bottom: 1rem;\n  font-size: 1.3rem;\n}\n\n.blessing-hint p {\n  color: #856404;\n  margin: 0;\n}\n\n.payment-section {\n  background: rgba(255, 255, 255, 0.9);\n  border-radius: 20px;\n  padding: 2rem;\n  backdrop-filter: blur(10px);\n}\n\n.payment-form h2,\n.payment-success h2 {\n  color: #333;\n  margin-bottom: 1rem;\n  text-align: center;\n}\n\n.payment-description {\n  text-align: center;\n  color: #666;\n  margin-bottom: 2rem;\n}\n\n.incense-selection {\n  display: flex;\n  flex-direction: column;\n  gap: 1.5rem;\n  margin-bottom: 2rem;\n}\n\n.input-group {\n  display: flex;\n  flex-direction: column;\n}\n\n.input-group label {\n  color: #333;\n  font-weight: 600;\n  margin-bottom: 0.5rem;\n}\n\n.count-input,\n.currency-select {\n  padding: 0.8rem;\n  border: 2px solid #ddd;\n  border-radius: 8px;\n  font-size: 1rem;\n  transition: border-color 0.3s;\n}\n\n.count-input:focus,\n.currency-select:focus {\n  outline: none;\n  border-color: #667eea;\n}\n\n.price-display {\n  text-align: center;\n  margin-bottom: 2rem;\n  padding: 1rem;\n  background: #f8f9fa;\n  border-radius: 8px;\n}\n\n.price-display p {\n  margin: 0;\n  font-size: 1.2rem;\n  color: #333;\n}\n\n.price {\n  font-weight: bold;\n  color: #667eea;\n}\n\n.payment-btn,\n.worship-btn {\n  width: 100%;\n  padding: 1rem;\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n  color: white;\n  border: none;\n  border-radius: 10px;\n  font-size: 1.2rem;\n  font-weight: 600;\n  cursor: pointer;\n  transition: all 0.3s ease;\n}\n\n.payment-btn:hover:not(:disabled),\n.worship-btn:hover {\n  transform: translateY(-2px);\n  box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);\n}\n\n.payment-btn:disabled {\n  opacity: 0.6;\n  cursor: not-allowed;\n}\n\n.worship-btn {\n  background: linear-gradient(135deg, #28a745 0%, #20c997 100%);\n}\n\n.worship-btn:hover {\n  box-shadow: 0 5px 15px rgba(40, 167, 69, 0.4);\n}\n\n.error-message {\n  margin-top: 1rem;\n  padding: 1rem;\n  background: #ffe6e6;\n  color: #cc0000;\n  border-radius: 8px;\n  text-align: center;\n}\n\n.payment-success {\n  text-align: center;\n}\n\n.success-info {\n  background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);\n  border-radius: 15px;\n  padding: 2rem;\n  margin: 1.5rem 0;\n}\n\n.success-icon {\n  font-size: 4rem;\n  color: #28a745;\n  margin-bottom: 1rem;\n}\n\n.success-info > p {\n  color: #155724;\n  font-size: 1.2rem;\n  font-weight: 600;\n  margin-bottom: 1.5rem;\n}\n\n.payment-details {\n  display: flex;\n  flex-direction: column;\n  gap: 0.8rem;\n}\n\n.detail-item {\n  display: flex;\n  justify-content: space-between;\n  padding: 0.5rem 0;\n  border-bottom: 1px solid #c3e6cb;\n}\n\n.detail-item:last-child {\n  border-bottom: none;\n}\n\n.label {\n  color: #495057;\n  font-weight: 500;\n}\n\n.value {\n  color: #155724;\n  font-weight: 600;\n}\n\n@media (max-width: 768px) {\n  .main-content {\n    grid-template-columns: 1fr;\n    gap: 1rem;\n  }\n\n  .result-section {\n    order: 2;\n  }\n\n  .payment-section {\n    order: 1;\n  }\n\n  .incense-selection {\n    gap: 1rem;\n  }\n}\n</style> "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}